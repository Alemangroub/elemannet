---
import Layout from '../../layouts/Layout.astro';
import { getProjects } from '../../data/projects.js';

export async function getStaticPaths() {
  const projects = await getProjects();
  return projects.map(project => ({
    params: { slug: project.slug },
    props: { project },
  }));
}

const { project } = Astro.props;
--- 
<Layout title={project.title}>
  <main class="project-detail-page" dir="rtl">
    <div class="container">
      
      <!-- Project Header -->
      <header class="project-header">
        <h1>{project.title}</h1>
        <p class="project-subtitle">{project.location}</p>
      </header>

      <!-- Main Image -->
      <div class="main-image-container">
        <img src={project.mainImage.src} alt={project.mainImage.alt} class="main-image" />
      </div>

      <!-- Project-specific Navigation -->
      <nav class="project-nav">
        <a href="#overview" class="nav-link active">Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©</a>
        <a href="#gallery" class="nav-link">Ù…Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±</a>
        <a href="#details" class="nav-link">Ø§Ù„ØªÙØ§ØµÙŠÙ„</a>
      </nav>

      <!-- Project Content -->
      <div class="project-content">
        
        <!-- Overview Section -->
        <section id="overview" class="project-section">
          <h2><i class="icon-overview"></i> Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</h2>
          <div class="overview-grid">
            <div class="overview-text">
              {project.description.map(paragraph => <p>{paragraph}</p>)}
            </div>
            <div class="key-features">
              <h3>Ø£Ø¨Ø±Ø² Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª</h3>
              <ul>
                {project.features.map(feature => <li><i class="icon-feature"></i>{feature}</li>)}
              </ul>
            </div>
          </div>
        </section>

        <!-- Gallery Section -->
        <section id="gallery" class="project-section">
          <h2><i class="icon-gallery"></i> Ù…Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±</h2>
          <div class="gallery-grid">
            {project.gallery.map(image => (
              <a href={image.src} data-fancybox="gallery" data-caption={image.alt}>
                <img src={image.src} alt={image.alt} loading="lazy" />
              </a>
            ))}
          </div>
        </section>

        <!-- Details Section -->
        <section id="details" class="project-section">
          <h2><i class="icon-details"></i> ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ©</h2>
          <ul class="details-list">
            <li><strong>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹:</strong> {project.type}</li>
            <li><strong>Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹:</strong> {project.status}</li>
            <li><strong>Ø§Ù„Ù…ÙˆÙ‚Ø¹:</strong> {project.location}</li>
          </ul>
        </section>

      </div>
      
      <div class="back-to-projects">
        <a href="/" class="btn"> <i class="icon-back"></i> Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
      </div>

    </div>
  </main>
</Layout>

<!-- Styles -->
<style>
  /* Font Icons (placeholders) */
  [class^="icon-"] { display: inline-block; margin-left: 0.5em; /* RTL support */ }
  /* Replace with actual icon font or SVG */
  .icon-overview::before { content: '\1F4C4'; } /* ğŸ“„ */
  .icon-gallery::before { content: '\1F4BB'; } /* ğŸ–¼ï¸ */
  .icon-details::before { content: '\1F4A1'; } /* ğŸ’¡ */
  .icon-feature::before { content: 'â­'; }
  .icon-back::before { content: '\2190'; } /* â† */

  .project-detail-page { background-color: #f9f9f9; padding: 2rem 1rem; font-family: 'Cairo', sans-serif; }
  .container { max-width: 1100px; margin: 0 auto; background: #fff; padding: 2rem 3rem; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }

  .project-header { text-align: center; margin-bottom: 2.5rem; border-bottom: 1px solid #eee; padding-bottom: 2rem; }
  .project-header h1 { font-size: 2.8rem; font-weight: 900; color: #2c3e50; margin-bottom: 0.5rem; }
  .project-header .project-subtitle { font-size: 1.3rem; color: #3498db; font-weight: 500; margin: 0; }

  .main-image-container { margin-bottom: 2.5rem; text-align: center; }
  .main-image { max-width: 100%; height: auto; border-radius: 10px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); }
  
  .project-nav { display: flex; justify-content: center; gap: 1rem; margin-bottom: 3rem; background: #f4f7f6; padding: 1rem; border-radius: 50px; }
  .project-nav .nav-link { color: #555; text-decoration: none; padding: 0.6rem 1.2rem; border-radius: 50px; font-weight: 700; transition: all 0.3s ease; }
  .project-nav .nav-link:hover, .project-nav .nav-link.active { background-color: #3498db; color: #fff; transform: translateY(-2px); box-shadow: 0 4px 10px rgba(52, 152, 219, 0.4); }

  .project-section { margin-bottom: 3.5rem; }
  .project-section h2 { font-size: 2rem; font-weight: 800; color: #2c3e50; margin-bottom: 1.5rem; padding-bottom: 0.5rem; border-bottom: 2px solid #3498db; display: inline-block; }

  .overview-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 2rem; align-items: flex-start; }
  .overview-text { line-height: 1.8; font-size: 1.1rem; color: #333; }
  
  .key-features { background-color: #f4f7f6; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #3498db; }
  .key-features h3 { margin-top: 0; font-size: 1.3rem; color: #2c3e50; }
  .key-features ul { list-style: none; padding: 0; margin: 0; }
  .key-features li { display: flex; align-items: center; margin-bottom: 0.8rem; font-size: 1rem; color: #444; }
  .key-features li .icon-feature { color: #f1c40f; margin-left: 10px; font-size: 1.2rem; }

  .gallery-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 1rem; }
  .gallery-grid img { width: 100%; height: 180px; object-fit: cover; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); transition: transform 0.3s, box-shadow 0.3s; cursor: pointer; }
  .gallery-grid img:hover { transform: scale(1.05); box-shadow: 0 8px 20px rgba(0,0,0,0.15); }

  .details-list { list-style: none; padding: 0; background-color: #f4f7f6; border-radius: 8px; padding: 1.5rem; }
  .details-list li { padding: 0.8rem 0; font-size: 1.1rem; border-bottom: 1px solid #e0e0e0; }
  .details-list li:last-child { border-bottom: none; }
  .details-list strong { color: #2c3e50; min-width: 120px; display: inline-block; }

  .back-to-projects { text-align: center; margin-top: 2rem; }
  .btn { display: inline-flex; align-items: center; background-color: #3498db; color: #fff; padding: 0.8rem 1.8rem; border-radius: 50px; text-decoration: none; font-weight: 700; transition: all 0.3s ease; }
  .btn:hover { background-color: #2980b9; transform: translateY(-3px); box-shadow: 0 4px 12px rgba(52, 152, 219, 0.4); }

  @media (max-width: 768px) {
    .container { padding: 1.5rem; }
    .project-header h1 { font-size: 2.2rem; }
    .overview-grid { grid-template-columns: 1fr; }
  }
</style>

<script>
  // Simple smooth scroll for navigation
  document.querySelectorAll('.project-nav a').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      e.preventDefault();
      document.querySelector(this.getAttribute('href')).scrollIntoView({ behavior: 'smooth' });

      // Active link switching
      document.querySelectorAll('.project-nav a').forEach(link => link.classList.remove('active'));
      this.classList.add('active');
    });
  });
</script>